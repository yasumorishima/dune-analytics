# 新JPYCの発行額・償還額・流通額をDune Analyticsで追跡する

## はじめに

以下ツイートを見たので、その数字に近しい数字が出るか試してみました。
それっぽくなったので、とりあえず書いてみました。

https://x.com/noritaka_okabe/status/2017048445048279481

## 概要

新JPYC（2025年10月27日ローンチ）のオンチェーンデータから発行額・償還額・流通額を推定するためのSQLクエリを作成しました。

- 月次版クエリ：月ごとの集計
- 日次版クエリ：日ごとの集計

**ダッシュボード**: https://dune.com/shogaku_toushi/jpyc-date

※ あくまでオンチェーンデータからの推定であり、実際の数値とは異なる可能性があります。

## 基本概念

### JPYCについて

JPYCは日本円に連動したステーブルコイン（デジタル通貨）です。一般的に1 JPYC = 1円の価値を持つとされています。

### 主要指標（このクエリでの定義）

**発行額（Issuance）**
JPYC社のウォレットから顧客に送付された総額（このクエリでの定義）

**償還額（Redemption）**
顧客からJPYC社のウォレットに返却された総額（このクエリでの定義）

**流通額（Circulating Supply）**
計算式：流通額 = 発行額 - 償還額

※ JPYC社の正式な定義とは異なる可能性があります。

### Mintと発行の違い（このクエリの考え方）

このクエリでは以下のように考えて作成しています：

- JPYC社は事前にJPYCをMint（鋳造）してウォレットに保管している
- 顧客が購入すると、この保管されたJPYCを送付する

つまり：
- Mint = 事前準備（内部処理）
- 発行 = JPYC社→顧客への送付（実際の発行）

と仮定してクエリを組み立てています。実際の仕組みとは異なる可能性があります。

## 使い方

### 方法1: 既存のクエリを使う（簡単）

1. 月次版: https://dune.com/queries/6603840
2. 日次版: https://dune.com/queries/6593053
3. 各ページで「Run」ボタンをクリック
4. 結果が表示されます

### 方法2: 自分でクエリを作成する

#### 1. Dune Analyticsにアクセス

https://dune.com/ にアクセスし、アカウントを作成します（無料）。

#### 2. 新しいクエリを作成

右上の「New Query」をクリックします。

#### 3. SQLをコピー＆ペースト

上記のクエリページから「Fork query」または「View query」でSQLをコピーしてエディタにペーストします。

#### 4. 実行

「Run」ボタンをクリックすると、結果が表示されます。

## 月次版クエリ

### 用途

- 全体の流れを把握
- 月ごとの成長トレンドを確認
- レポート作成

### 構成（8 CTE）

| # | CTE名 | 役割 |
|---|--------|------|
| 1 | `jpyc_wallets` | Mintイベントの受取先からJPYC社ウォレットを動的判定 |
| 2 | `all_transfers` | 3チェーンの全Transferイベントを取得（10/27以降） |
| 3 | `jpyc_issuance_and_redemption` | 各Transferを発行/償還/一般送金に分類 |
| 4 | `active_month_chains` | JPYC社が関与するTransferがある月×チェーン |
| 5 | `monthly_stats_by_chain` | 月次・チェーン別の発行額と償還額 |
| 6 | `complete_monthly_stats` | 活動がある全組み合わせにデータを結合 |
| 7 | `monthly_stats_total` | 全チェーン合計の月次統計 |
| 8 | `global_cumulative` | 全体累積値を事前計算 |

### 出力項目

| 項目名 | 説明 |
|--------|------|
| 年月 | 集計対象の月（例：2026-01） |
| チェーン | Ethereum、Polygon、Avalanche のいずれか |
| 月次発行額 (億円) | その月にJPYC社ウォレットから送付された金額（クエリでの定義） |
| 月次償還額 (億円) | その月にJPYC社ウォレットに返却された金額（クエリでの定義） |
| 月次純増額 (億円) | 発行額 - 償還額 |
| 累積発行額 (億円) | 開始からその月までの発行総額 |
| 累積償還額 (億円) | 開始からその月までの償還総額 |
| 累積流通額 (億円) | その月時点での計算上の流通額（発行額 - 償還額） |
| 全体累積発行額 (億円) | 全チェーン合計の累積発行額 |
| 全体累積償還額 (億円) | 全チェーン合計の累積償還額 |
| 全体累積流通額 (億円) | 全チェーン合計の累積流通額 |

### SQLコード

https://dune.com/queries/6603840

## 日次版クエリ

### 用途

- 日々の変動を詳しく追跡
- 特定のイベント日の影響を分析
- 詳細なグラフを作成

### 月次版との違い

- 集計単位：月 → 日
- 精度：日次発行額は小数点第4位まで表示
- データ量：より詳細だが行数が多い

### 構成（19 CTE）

| # | CTE名 | 役割 |
|---|--------|------|
| 1 | `jpyc_wallets` | JPYC社ウォレットの動的判定 |
| 2 | `all_transfers` | 3チェーンの全Transferイベント取得 |
| 3 | `date_range` | データの日付範囲を取得 |
| 4 | `all_days` | 全日付を生成（歯抜け防止） |
| 5 | `all_chains` | 全チェーンのリスト |
| 6 | `all_day_chains` | 全日×全チェーンの組み合わせ |
| 7 | `jpyc_issuance_and_redemption` | 発行/償還/一般送金に分類 |
| 8 | `daily_stats_by_chain` | 日次・チェーン別の発行額と償還額 |
| 9 | `complete_daily_stats` | 全組み合わせにデータ結合（0埋め） |
| 10 | `normal_transfers` | 一般送金のみ抽出（ユーザー計算用） |
| 11 | `all_addresses_by_chain` | チェーン別の全アドレス |
| 12 | `first_appearance_by_chain` | チェーン別の初回出現日 |
| 13 | `daily_new_users_by_chain` | チェーン別の日次新規ユーザー |
| 14 | `all_addresses_global` | 全チェーン統合のアドレス |
| 15 | `first_appearance_global` | グローバル初回出現日 |
| 16 | `daily_new_users_global` | グローバル日次新規ユーザー |
| 17 | `with_users` | チェーン別ユーザーデータ結合 |
| 18 | `with_global_daily` | グローバルユーザーデータ結合 |
| 19 | `activity_flag` | 活動がある日のフラグ |

### 追加項目

月次版の項目に加えて：
- 日次新規ユーザー（チェーン別）
- 累積ユーザー数（チェーン別）
- 総累積ユニークユーザー数

### SQLコード

https://dune.com/queries/6593053

## 活用方法

### グラフ作成

Duneの「Visualizations」機能で作成可能：
- 棒グラフ：月次発行額（チェーン別スタック）
- エリアグラフ：累積発行額・償還額・流通額の推移
- 折れ線グラフ：流通額のトレンド

### ダッシュボード作成

複数のクエリを組み合わせて総合ダッシュボードを作成できます。

### データエクスポート

結果を CSV でダウンロードして Excel や Google Sheets で加工できます。

## よくある質問

**Q: なぜチェーンが3つあるのか**
A: このクエリでは Ethereum、Polygon、Avalanche の3つのブロックチェーンを対象にしています。

**Q: 「全体累積発行額」が Avalanche の行にしか出ない理由**
A: 表示の重複を避けるため、各月で1回だけ（Avalanche の行に）表示しています。この値は全チェーンの合計です。

**Q: データが表示されない日がある**
A: そのチェーンでその日に発行・償還・送金のいずれも発生しなかった場合、行自体が表示されません。

**Q: JPYC社のウォレットアドレスの判定方法**
A: このクエリでは、Mintイベント（トークン鋳造）の受取先アドレスをJPYC社のウォレットとして判定しています。実際のJPYC社の運用とは異なる可能性があります。

## 参考資料

- Dune Analytics 公式ドキュメント: https://dune.com/docs/
- SQL 基礎: https://dune.com/docs/query/syntax/
- ブロックチェーンデータ分析: https://dune.com/docs/learning/what-is-dune/

## 補足

作成日: 2026年1月31日
対象: 新JPYC（2025年10月27日ローンチ）
チェーン: Ethereum, Polygon, Avalanche

**注意事項**
このクエリは個人が作成したものです。JPYC社の公式な集計方法や定義とは異なる可能性があります。計算ロジックに誤りがある可能性もありますので、ご利用の際はご自身で検証してください。参考程度にご覧ください。
